
На основе анализа предметной области, а также примеров контрактов и дополнительных соглашений к ним была спроектирована модель данных. В рамках настоящего проекта модель упрощена в целях ускорения реализации демонстрационной версии системы.

Далее следует текстовое описание сущностей модели данных. Каждая сущность представлена в виде набора свойств. Свойства могут быть трёх типов: простых, составных и списком. Структура составных свойств представлена в виде отдельных сущностей. Описание сущностей приведено в порядке понижения уровня иерархии.

## Основные сущности

* <a id="contract"></a> **Контракт**
	- Шапка контракта
	- Данные сторон контракта
		- Список положений
	- Предмет контракта
		- Список положений
	- Условия контракта
		- Список положений
	- Права и обязанности сторон
		- Список положений
	- Ответственность сторон
		- Список положений
	- Реквизиты сторон
	- Техническое задание (часть контракта или ссылка на внешний документ)

-  <a id="agreement"></a>**Дополнительное соглашение**
	- Шапка дополнительного соглашения
	- Основание дополнительного соглашения
	- Условия дополнительного соглашения
		- Список положений
		- Список позиций спецификации
	
	
- **Шапка контракта**
	- Номер контракта
	- Тип контракта
	- Наименование контракта
	- Город
	- Код контракта
	- Дата подписания контракта

- **Шапка дополнительного соглашения**
	- Номер дополнительного соглашения
	- Номер контракта
	- Наименование контракта
	- Город
	- Дата подписания дополнительного соглашения
	- Информация об инициаторе дополнительного соглашения

- **Техническое задание**
	- Объект закупки
		- Список положений
	- Характеристики объекта закупки
		- Список положений
	- Требования к объекту закупки
		- Список положений
	- Требования по соответствию
		- Список положений
	- Спецификация
		- Список позиций с обозначением количества и цен
	
 - **Положение контракта / ТЗ** 
	 - номер положения
	 - номер версии положения
	 - флаг видимости
	 - текст положения
		Текст положения может содержать ссылки на другие положения контракта или его приложений. Алгоритм их отслеживания и актуализации требуется определить в последующих итерациях разработки сервиса

- **Позиция спецификации**
	- номер позиции
	- версия позиции
	- флаг видимости
	- наименование позиции
	- объем закупки
	- срок поставки
	- дополнительная информация


## Принцип работы с контрактами

Первоначально контракт составляется на основе шаблонной структуры, представленной сущностью [**Контракт**](#contract). Содержимое контракта представляется набором пронумерованных положений, каждое из которых имеет счётчик версий, установленный в исходное положение (ноль).

Когда пользователь обращается к системе с целью изменить условия Контракта, система выполняет выборку соответствующих положений. На основе вновь поступившей информации от пользователя текст положения может быть изменён, положение может быть удалено, могут быть добавлены новые положения. 

При изменении, добавлении или удалении положения изменяется номер версии положения. Номер версии соответствует номеру редакции Контракта. При удалении или добавлении нового положения происходит обновление сквозной нумерации в рамках всего контракта. 

При удалении положения его флаг (признак) видимости изменяется. Изменить флаг видимости впоследствии невозможно. Однако, текст удалённого положения остаётся доступным. В последующих итерациях разработки приложения будет принято решение о возможности восстановления удалённых положений из прошлых редакций Контракта.

По завершению процесса внесения изменений производится выборка положений Контракта (а также позиций спецификации) с максимальным номером версии. На основе полученного списка формируется документ: [**Дополнительное соглашение**](#agreement).

В каждый момент времени актуальная версия Контракта доступна благодаря автоматической актуализации всех версий его положений. История изменений, внесённых в Контракт, доступна в виде списка заключённых Дополнительных соглашений.